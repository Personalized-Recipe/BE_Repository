{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{recipeAPI}from'../services/api';import'./RecipePage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RecipePage=()=>{const navigate=useNavigate();const[request,setRequest]=useState('');const[recipe,setRecipe]=useState(null);const[history,setHistory]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState('');const userId=localStorage.getItem('userId');const isLoggedIn=!!userId;useEffect(()=>{if(isLoggedIn){fetchRecipeHistory();}},[isLoggedIn]);const fetchRecipeHistory=async()=>{try{const response=await recipeAPI.getHistory(userId);setHistory(response.data);}catch(err){console.error('레시피 기록을 불러오는데 실패했습니다:',err);}};const handleRequestChange=e=>{setRequest(e.target.value);};const handleSubmit=async e=>{e.preventDefault();if(!request.trim())return;setLoading(true);setError('');setRecipe(null);try{const recipeRequest={userId:isLoggedIn?userId:null,request:request};const response=await recipeAPI.requestRecipe(recipeRequest);setRecipe(response.data);if(isLoggedIn){fetchRecipeHistory();}}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'레시피 생성 중 오류가 발생했습니다.');}finally{setLoading(false);}};const handleHistoryClick=recipe=>{setRecipe(recipe);setRequest(recipe.request);};return/*#__PURE__*/_jsxs(\"div\",{className:\"recipe-page\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uB808\\uC2DC\\uD53C \\uCD94\\uCC9C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"recipe-form-container\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"recipe-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"request\",className:\"form-label\",children:\"\\uC5B4\\uB5A4 \\uB808\\uC2DC\\uD53C\\uB97C \\uC6D0\\uD558\\uC2DC\\uB098\\uC694?\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"request\",value:request,onChange:handleRequestChange,className:\"form-control\",placeholder:\"\\uC608: \\uC624\\uB298 \\uC810\\uC2EC\\uC73C\\uB85C \\uAE30\\uB984\\uC9C4 \\uC74C\\uC2DD\\uC744 \\uBA39\\uACE0 \\uC2F6\\uC5B4\\uC694.\",rows:\"3\",required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-actions\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",disabled:loading,children:loading?'레시피 생성 중...':'레시피 추천 받기'})})]}),!isLoggedIn&&/*#__PURE__*/_jsxs(\"div\",{className:\"login-prompt\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"\\uD68C\\uC6D0\\uAC00\\uC785\\uC744 \\uD558\\uC2DC\\uBA74 \\uB354 \\uC815\\uD655\\uD55C \\uB808\\uC2DC\\uD53C \\uCD94\\uCC9C\\uACFC \\uAE30\\uB85D \\uC800\\uC7A5\\uC774 \\uAC00\\uB2A5\\uD569\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/register'),className:\"btn btn-secondary\",children:\"\\uD68C\\uC6D0\\uAC00\\uC785 \\uD558\\uAE30\"})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),recipe&&/*#__PURE__*/_jsxs(\"div\",{className:\"recipe-result\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uCD94\\uCC9C \\uB808\\uC2DC\\uD53C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"recipe-content\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"recipe-request\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\uC694\\uCCAD:\"}),\" \",recipe.request]}),/*#__PURE__*/_jsx(\"div\",{className:\"recipe-response\",children:recipe.response.split('\\n').map((line,index)=>/*#__PURE__*/_jsx(\"p\",{children:line},index))})]})]}),isLoggedIn&&history.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"recipe-history\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uC774\\uC804 \\uB808\\uC2DC\\uD53C \\uAE30\\uB85D\"}),/*#__PURE__*/_jsx(\"div\",{className:\"history-list\",children:history.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"history-item\",onClick:()=>handleHistoryClick(item),children:[/*#__PURE__*/_jsx(\"p\",{children:item.request}),/*#__PURE__*/_jsx(\"span\",{className:\"history-date\",children:new Date(item.createdAt).toLocaleDateString()})]},item.id))})]})]});};export default RecipePage;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","recipeAPI","jsx","_jsx","jsxs","_jsxs","RecipePage","navigate","request","setRequest","recipe","setRecipe","history","setHistory","loading","setLoading","error","setError","userId","localStorage","getItem","isLoggedIn","fetchRecipeHistory","response","getHistory","data","err","console","handleRequestChange","e","target","value","handleSubmit","preventDefault","trim","recipeRequest","requestRecipe","_err$response","_err$response$data","message","handleHistoryClick","className","children","onSubmit","htmlFor","id","onChange","placeholder","rows","required","type","disabled","onClick","split","map","line","index","length","item","Date","createdAt","toLocaleDateString"],"sources":["/Users/lhj/Workspace/prompt-test/frontend/src/pages/RecipePage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { recipeAPI } from '../services/api';\nimport './RecipePage.css';\n\nconst RecipePage = () => {\n  const navigate = useNavigate();\n  const [request, setRequest] = useState('');\n  const [recipe, setRecipe] = useState(null);\n  const [history, setHistory] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const userId = localStorage.getItem('userId');\n  const isLoggedIn = !!userId;\n\n  useEffect(() => {\n    if (isLoggedIn) {\n      fetchRecipeHistory();\n    }\n  }, [isLoggedIn]);\n\n  const fetchRecipeHistory = async () => {\n    try {\n      const response = await recipeAPI.getHistory(userId);\n      setHistory(response.data);\n    } catch (err) {\n      console.error('레시피 기록을 불러오는데 실패했습니다:', err);\n    }\n  };\n\n  const handleRequestChange = (e) => {\n    setRequest(e.target.value);\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!request.trim()) return;\n\n    setLoading(true);\n    setError('');\n    setRecipe(null);\n\n    try {\n      const recipeRequest = {\n        userId: isLoggedIn ? userId : null,\n        request: request\n      };\n\n      const response = await recipeAPI.requestRecipe(recipeRequest);\n      setRecipe(response.data);\n      \n      if (isLoggedIn) {\n        fetchRecipeHistory();\n      }\n    } catch (err) {\n      setError(err.response?.data?.message || '레시피 생성 중 오류가 발생했습니다.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleHistoryClick = (recipe) => {\n    setRecipe(recipe);\n    setRequest(recipe.request);\n  };\n\n  return (\n    <div className=\"recipe-page\">\n      <h2>레시피 추천</h2>\n      \n      <div className=\"recipe-form-container\">\n        <form onSubmit={handleSubmit} className=\"recipe-form\">\n          <div className=\"form-group\">\n            <label htmlFor=\"request\" className=\"form-label\">어떤 레시피를 원하시나요?</label>\n            <textarea\n              id=\"request\"\n              value={request}\n              onChange={handleRequestChange}\n              className=\"form-control\"\n              placeholder=\"예: 오늘 점심으로 기름진 음식을 먹고 싶어요.\"\n              rows=\"3\"\n              required\n            />\n          </div>\n          <div className=\"form-actions\">\n            <button type=\"submit\" className=\"btn btn-primary\" disabled={loading}>\n              {loading ? '레시피 생성 중...' : '레시피 추천 받기'}\n            </button>\n          </div>\n        </form>\n\n        {!isLoggedIn && (\n          <div className=\"login-prompt\">\n            <p>회원가입을 하시면 더 정확한 레시피 추천과 기록 저장이 가능합니다.</p>\n            <button onClick={() => navigate('/register')} className=\"btn btn-secondary\">\n              회원가입 하기\n            </button>\n          </div>\n        )}\n      </div>\n\n      {error && <div className=\"error-message\">{error}</div>}\n\n      {recipe && (\n        <div className=\"recipe-result\">\n          <h3>추천 레시피</h3>\n          <div className=\"recipe-content\">\n            <p className=\"recipe-request\"><strong>요청:</strong> {recipe.request}</p>\n            <div className=\"recipe-response\">\n              {recipe.response.split('\\n').map((line, index) => (\n                <p key={index}>{line}</p>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {isLoggedIn && history.length > 0 && (\n        <div className=\"recipe-history\">\n          <h3>이전 레시피 기록</h3>\n          <div className=\"history-list\">\n            {history.map((item) => (\n              <div \n                key={item.id} \n                className=\"history-item\"\n                onClick={() => handleHistoryClick(item)}\n              >\n                <p>{item.request}</p>\n                <span className=\"history-date\">\n                  {new Date(item.createdAt).toLocaleDateString()}\n                </span>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default RecipePage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}